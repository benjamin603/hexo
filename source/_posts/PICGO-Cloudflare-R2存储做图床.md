---
title: PicGo+Cloudflare-R2存储做图床
categories: 折腾记录
tags: Cloudflare
abbrlink: 32684
date: 2024-02-02 08:38:52
index_img: https://r2.snbing.com/img/cover/dcac2a59d6ac01a1.webp
sticky:
comment:
---

Cloudflare R2存储允许开发人员存储大量非结构化数据，而无需支付与典型云存储服务相关的昂贵出口带宽费用。也算是带宽联盟一员。类似于阿里云国际的OSS免费5G空间，流量收费，但是使用自定义域名套用Cloudflare的cdn就流量免费，Cloudflare自己的R2存储流量不收费，收费的是存储空间和请求次数。A类操作和B类操作分开收费，上传属于A类操作，下载和访问属于B类操作。

<!--more-->

也就是说，可以免费存储10G的文件，每个月可以上传100万次，访问1000万次，假如用作图床，一般是用不到这个量级的。并且可以绑定自定义域名，套用页面规则以后可以设置浏览器缓存，这样可以减少一些请求次数并且可以防止被人刷请求次数导致一晚上过去，房子就不属于自己了。不自定义域名也是可以的，也就是说你甚至不需要拥有域名就可以拥有一个图床。

## 开通R2

首先当然是拥有一个Cloudflare账号，并且点击右上角的语言设置中文。

第一步当然是开通R2，侧边栏找到R2然后点击开通。这里可以绑定支持外币支付的卡，或者直接绑定paypal，中国区的paypal也是可以的。

## 创建存储桶

> 不建议无脑选亚太地区，亚太地区虽然近但是国际访问速度受限，我这里选择北美西部

## 自定义域名

选择`连接域`并输入自己想要的域名，如果域名已经托管至Cloudflare会自动解析，否则需要手动解析才会生效！

## 开通API

回到R2**的概述界面，点击右上角的 **管理 R2 API 令牌，** 然后点击右上角的**创建api令牌****

> **权限**：选择**对象读和写**；**TTL**：选择**永久**
>
> 创建完成令牌以后请把**访问密钥 ID**和**机密访问密钥**收藏好，只会显示这一次，以后用的时候就找不到了，记下来以后还能用到。当然，如果没记住的话，以后再创建一个api令牌也是可以的

## 配置PicGo

搜索并安装插件：**S3 1.3.4**

插件配置：

| 选项        | 值                                                           |
| ----------- | ------------------------------------------------------------ |
| 图床配置名  | 任意填写                                                     |
| 应用密钥 ID | **访问密钥 ID**                                              |
| 应用密钥    | **机密访问密钥**                                             |
| 桶名        | 创建的R2桶名                                                 |
| 文件路径    | 自定义（保持默认）                                           |
| 自定义节点  | **存储桶详细信息**中的**S3 API**                             |
| 自定义域名  | 填入第三步设定的自定义域名+桶名。例：`https://r2.snbing.com/img` |

